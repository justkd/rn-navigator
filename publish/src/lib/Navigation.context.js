"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.useNavigationContext=void 0;const react_1=require("react"),Navigation_tokens_1=require("./Navigation.tokens"),useNavigationContext=(state,dispatch,routes,initialRoute,baseDur,backgrounds)=>{const navigate=(0,react_1.useCallback)(((to,opts)=>{const{payload:payload,background:background}=opts||{};dispatch({type:"navigate",event:{to:to,payload:payload,background:background}})}),[dispatch]),to=(0,react_1.useMemo)((()=>{const entries=Object.keys(routes).map((k=>[k,k]));return Object.fromEntries(entries)}),[routes]),bg=(0,react_1.useMemo)((()=>{const entries=Object.keys(backgrounds).map((k=>[k,k]));return Object.fromEntries(entries)}),[backgrounds]),peek=(0,react_1.useCallback)((()=>{const peeked={...state};return Object.freeze(peeked),Object.seal(peeked),peeked}),[state]),payload=(0,react_1.useCallback)((n=>{const load=(n?[...state.history].reverse()[n-1]:state.queue[0])?.payload||null;return load||null}),[state.history,state.queue]),clear=(0,react_1.useCallback)((background=>{dispatch({type:"navigate",event:{to:initialRoute,background:background}}),setTimeout((()=>{dispatch({type:"clear"})}),2*baseDur)}),[dispatch,initialRoute,baseDur]),set=(0,react_1.useCallback)((next=>{dispatch({type:"set",event:next})}),[dispatch]),route=(0,react_1.useCallback)((n=>(n?[...state.history].reverse()[n-1]?.to:state.queue[0]?.to)||null),[state.history,state.queue]),back=(0,react_1.useMemo)((()=>Navigation_tokens_1.backToken),[]),navigator=(0,react_1.useMemo)((()=>({peek:peek,clear:clear,payload:payload,route:route,set:set})),[payload,peek,clear,set,route]);return{ctx:(0,react_1.useMemo)((()=>({navigate:navigate,to:to,bg:bg,back:back,navigator:navigator})),[navigate,to,bg,back,navigator])}};exports.useNavigationContext=useNavigationContext;